#include <stdio.h>
#include <math.h>
#include <avr/pgmspace.h>

const double WEIGHT[] PROGMEM = {0.120246392420696,9.34117854214066,2.74547800514145,-20.9366422096784,7.70932836038758,1.57750993760557,10.6110441965327,-0.146829650534326,-5.43750672473446,-1.94148705329952,-0.118150854888909,-3.59092495857086,0.862239996275232,7.81907220716004,-8.45483360459217,-0.935435762097729,3.01506922127714,2.05091257145881,-0.117237694511465,-6.62082420754927,-0.371280805508435,-0.305531967262616,8.85981605557047,0.898722588133456,-4.84420745126681,3.69845154947739,9.30613606623731,-6.86786193469075,-13.0369304067759,3.23884984730686,-7.92863007735287,0.989641085125736,-4.29960175198001,9.42136005221488,12.7309739878899,0.209657707319173,-10.0175549161751,-3.54761461403672,6.63009773766308,8.44874941111965,0.596253562849017,9.70914394060032,-7.82778238562896,8.79518357387594,11.0875616312552,-4.9314435219691,0.604849889069461,-0.485718714256647,8.93876812237057,5.36515962971512,0.10672740849674,-6.47539944661003,-3.0947867125351,-11.3829285689551,-8.54114874531722,0.00176090267469791,0.951817691281283,-10.2118240386037,2.73304904895349,-3.40290389923315,11.02063839281,-0.67296554551293,-3.10445430399047,-3.74748600164689,-6.60429197905227,2.90765397247831,0.0639882990894557,-4.87297715457434,7.04174961287822,5.04242617225878,1.82646465566587,9.78488269498419,0.303921470707884,5.05313720893348,-12.7182209058382,-8.50918106758946,0.0633109488377034,-4.86560857933928,-5.83427194620866,-14.8672993570599,-1.68662849694218,-0.402109991126078,-13.0267813127379,0.570637338994148,-19.5817270395238,3.44828501701229,-1.87174829526131,-3.21692203142091,-14.2155882299851,-14.2746266469285,-0.340043548188587,6.14551411755797,9.95914691356103,-0.160606631548227,2.57190018741062,0.213092993477772,5.51684506713561,-0.147273014262875,2.66929785499483,-5.80334468195226,1.69402793367219,0.234362052787891,-3.21526071293584,6.91839244864944,-5.11430512982524,-0.528561216523003,2.73059464774766,-4.15538520137398,-4.96242083191798,0.0506964429890181,5.72852509975381,-7.79157296353628,2.04903587536454,-4.08090664330989,-1.25494709924777,-0.635598680137335,-3.62894404940633,8.89655789335296,17.5574280693,8.30881637683129,2.96092696610137,-2.50542816626884,0.423939856595403,-0.626464604239327,0.670826248252125,1.7078501361506,-1.72044359343897,0.718361616184575,-0.933116032504862,-0.378018086537032,-0.338123485514637,2.2960325636249,-0.235972756413186,0.948792735970265,-0.666192639678173,1.15749469227487,0.61591218817967,-0.684531443512033,0.137656148759037,-2.6133204117538,-0.319842496819584,-0.597273151812577,0.0404103701897873,-3.39229794500745,0.474866186432297,-0.330820898240196,3.995742936872,2.71698384241204,-0.956628971547069,-0.170572141393584,0.87705058056051,-0.370309493292744,-1.03374311049184,1.32154574994243,-0.288240813894693,3.17038323548818,-1.53510239693869,1.47476623937083,-1.07050770633194,5.75105272583554,-0.626247044762837,0.793982385173169,12.0515780855668,-1.2479239290781,-1.50806966364799,0.638575803030673,-0.473807952321097,0.455344837758811,-2.72561210040244,0.538250069612632,0.560564428287981,-0.416535167301087,1.62395973349895,-0.773982792650653,0.947306587491746,-0.815008269707328,0.770687752737867,1.07165812095697,0.937644708452683,-0.5211264725857,-1.35757467044312,-0.295365160900668,-0.617150140025924,-0.493630419014233,-0.246188715667617,-0.839326187893293,0.969068051793145,-1.07072164338147,-0.398237191656641,-0.806666196727837,0.93229988071466,-0.442998114040907,-0.992957113152537,-0.701266386470674,-0.616786432592182,1.89423523573622,0.210655053183121,-0.959118039208334,0.568052191002766,-0.745794728976964,1.44264542838757,-1.66119698528626,-0.587048163098598,0.151492408206659,-0.758615731531119,-0.956999272697107,-1.24084220525916,0.590499973672067,0.837393397128593,2.29512137431163,-0.581228816875061,0.619801575321903,0.702892249619847,0.788448473822178,1.12121265236312,0.314776781892773,1.39898815239406,0.773728488195513,0.00727327670730693,0.111688697693686,-1.08781812039301,1.83192600306682,0.0308520144332155,0.361735333491026,1.56744659336579,-0.840963028283379,-0.112432674436818,0.894641704838792,-1.051049252624,1.39941057382755,-0.303573544149099,1.14464579090749,-0.329230695094198,-0.614910842377363,-0.41962090239966,0.517435337016874,-5.64946992681489,-3.08732055951661,0.0105945579722875,1.2374514170804,0.295694389785753,-0.650024871490333,-0.989410762758133,1.82049856129284,-10.7124223178863,0.552764596631182,0.0320566277966027,-0.0462654773197245,0.290878833461858,1.4569996823611,-1.00848886195082,0.151063029379587,-0.30757760577743,0.889097156615938,0.0502920261111699,-1.94052797801879,0.717645153475187,-1.27983401584173,2.88501986573761,1.51912135552292,0.940622497184746,-0.516010604172303,1.19787226063095,0.172912437170902,-0.419562407210008,-0.164232383400185,-0.539417941240605,0.825034388962089,-0.274329773048075,0.339285999310057,1.02672760123431,-0.200866665370091,0.623060906504611,0.649203749583829,-1.20892502459201,0.252578448523141,0.416280584154887,0.535130462377593,-1.29168872927899,0.476567408865456,-0.178249546857046,0.511310130626797,-0.217613429707993,0.715779242223463,-0.28383987680465,-0.212975709648082,-1.29252066882113,1.17005127525107,-1.03577618239544,-0.112896796355796,-1.26208876970892,1.61054396811921,-0.228718993487716,0.169939178262989,0.628530256053224,1.69184134333357,-0.862411365914387,0.207599518669068,-2.09380425173399,-0.103312387153447,-0.862022628018529,0.90249419319115,0.54873998102253,1.04262925918086,-0.648697161088212,0.179079081844561,-1.89570371705931,2.4496598239633,-0.491459211354204,1.07547075311102,-1.46684977470809,-0.309019677830505,0.456753929188325,0.974412880148788,1.08484942412676,0.115890775469616,-0.507760266530888,1.20330106363024,0.938787605792086,-0.596843540961311,-1.51234935480306,1.03451913322494,1.0787225777469,-0.332562235470066,0.776934139660111,0.617915346282911,-0.106045815760241,0.643400320476708,-4.34463949292731,2.4701369186881,-0.630999882374707,-1.22158998233998,2.28589052444503,1.21368169526943,-3.39642392504828,-0.575478727617637,5.48589876140557,-0.311748561062089,-2.6047650145865,-0.306601085837004,-3.10337126847319,0.456347595651872,0.987392309354561,-1.9052616946297,2.51032367350039,-0.815243368807234,-0.821361090836848,2.23512707290513,-0.391678669379538,-0.284411206875549,-0.724676593261373,-1.16876812778724,-7.54000391530536,-0.811765454034803,0.397130036874018,-1.13534663350268,-0.656006034448625,0.928241069968879,-0.504161041411705,2.18050372265034,-1.45043135422676,-1.86194494136004,0.101955657443633,3.25370537669047,-2.05423648481172,0.92529029472267,0.377722537634444,-0.336323015917892,-0.828424811337421,0.180363080580257,1.93377126133945,1.52262784761159,3.93670092821818,-1.37023377846547,0.389726291398598,-0.368682502394568,1.81508999158216,1.54152979138228,0.464579072149726,1.06427620847646,-0.672165710082145,1.50843810166861,-0.305382229921761,0.449603809917101,0.724358814488947,-1.28061991810599,1.11590411198185,0.558350504226934,0.485392336382154,0.944371304522545,1.04965145499567,0.656810322668866,-0.897797500496261,1.19909716443329,2.12644971320914,0.23919476161509,-2.40256548037434,0.838182635837175,0.31115578216164,-0.0558785070988197,-0.0145252116774014,-2.32483931696252,-0.103616939236301,-0.575820056713943,1.65330052932278,-1.98906674235616,-0.442966520010084,0.311065875560352,2.13205993241523,0.303389409635202,2.22453374288062,-0.12376849072012,0.22918965027493,-0.493577171419259,0.838312781137041,-1.91957385797874,-0.188107218969901,1.00407028040313,-0.273016196489059,-0.238013634024739,-0.162702820617612,0.342065310973574,0.324099341835452,-0.949756008731638,-0.574990793879792,1.69413570462592,2.73546178286604,0.569659305478111,-0.251108228787512,-1.58050944863392,0.871626674338785,0.788674475810168,0.821322774409098,-9.50618600480899,-2.28143795792891,1.05366106029779,0.585154878332082,-0.215390652467369,3.87759909340306,0.373471881717478,0.908207695308138,-0.37889067287456,1.60445056268089,0.653428236897181,0.650569813276868,0.493197139175392,3.5612216903745,-1.23631436871976,0.250870769564677,6.07634621930163,-0.553161019025697,-0.412880348360456,-4.19660804600273,-0.0403818354130085,-1.54527912233592,-2.01677457360729,3.30468896683792,1.7490370636585,-3.24488412631851,-1.38266225362739,0.841588455057305,-0.39613915292481,0.402186567989278,-2.02217661124583,0.460451004747831,-0.128113347460776,0.339783435908718,0.483350269189004,0.863735492396196,-0.682059764429423,5.14942408347475,1.5259722585682,-0.242012912423634,-0.609638750728028,8.99275204021539,-12.0494156895627,-1.61401279964406,-0.708598137137672,-0.838798623337665,1.81043156433852,0.871383628181642,0.614747927874575,-0.650354644786671,0.663952042437059,0.268456680868237,0.576047010707676,4.08362351686791,-0.384492021494581,-0.705608505414352,-0.369768985856071,-1.27748018090243,-0.598874473677426,1.75839230310395,-2.03565856932546,0.166870447506826,0.382329047695507,1.38430320881744,0.144017274069612,0.0354996900144335,2.41324821935954,1.2167474608385,-2.0529854406147,0.233684730737389,1.51076156007553,1.14836419164252,-0.338361503056919,0.996544520860438,3.20748495039829,-3.31031356463387,-0.743500182349724,-0.652238929172322,-2.29459333080358,-2.16172604056786,-0.606782454253233,-0.983983818416723,0.877764688416361,7.66410568093054,1.24144665034639,-0.27086912597798,2.94527787984273,0.807007236464108,1.12519844198716,-0.727642633694828,-7.57678297404939,-15.007707033977,3.4536029809074,-1.00417752925652,-0.762817303810906,9.22560441253552,6.3518825940859,-1.13054256804261,-8.30660269530961,0.949632861358235,-0.465978474964871,2.73799045955121,-0.927963789266055,-0.539853892122306,-1.09867814023343,1.0801394318604,1.58610351451828,-2.23980925411426,-1.52818734752204,0.51160104761713,-0.476067964649083,-3.9989614355695,3.85405260394139,1.67128478776226,0.210117805611635,1.6632171620188,4.48387607922432,1.12794078456249,0.753713760957316,-1.59749612350992,-0.564949382570278,-0.411190756348714,0.648403897398941,-0.319916294361418,-3.84891547436125,-0.476372637706168,-0.040009547192694,0.723000751019425,6.09533063901241,0.0217387186302096,0.501390378064193,-0.1680549438814,4.34213060883717,1.12409547427418,0.607584433950266,1.0056100632239,-0.374989290991547,1.76356124911748,-0.331761461158682,-18.2759700514178,-0.313761183793307,2.85764456142566,-2.64814779518035,0.178218430506445,-0.205404900340299,4.04490597075478,-0.0946222623183079,0.858010557983834,4.92087667112999,-16.5403325864947,-3.11214494238868,-0.648359233036499,-24.3896635596549,29.2348667552087,-0.214952881910076,0.276028659883832,54.6115656202176,4.71431941364956,-0.479966614840813,0.668954743958248,23.243079047937,4.06156588511704,0.312454852430331,0.0774524336530832,-10.5514781089047,-11.091540425103,-0.428701171266591,-0.1681309559029,-13.3796305773582,3.26130515851672,-1.9555151315118,0.771619706616653,2.02317348364679,-166.10347645164,0.0814068857913477,-0.970838635253495,4.14367538631048,3.61042109258212,-27.8604879702905,-0.369487659323735,-12.18665247357,0.523743856757,0.689213813722387,0.211988413900575,0.254470751217475,-0.569958723204044,0.323655861170103,-0.3748223881498,0.776450920147406,-1.12725386561109,2.09411753061064,0.957910081451642,0.840082972910798,-2.19738167681282,0.721680183365423,1.54727302878434,0.916943362303321,0.959666665830914,1.93022458036326,-0.55079350321442,0.0227993233798964,-1.25834364481088,1.63370629636254,-0.114442083253564,0.458986052226699,1.85129824148983,-0.893479604454157,-0.106722585342941,0.998427830071341,0.148252698679298,0.765245019362272,-1.23493092569623,0.361007245109265,0.172112714022246,1.97874554595956,-0.132203949736116,0.515348633525331,-0.518841650035059,-4.3283952403013,-0.286347376663906,0.0944595622238893,2.22070461524451,-0.558640553877237,0.562295992737902,-2.19887121886664,0.597849366959889,0.138522963068371,-1.34076093833124,1.5003360096261,0.825729537397017,-1.35485831230977,-1.70284887722718,-0.228338066171846,0.304146607732607,-3.96649322485368,2.31073171121696,-1.15235547360167,0.853335490631978,-2.21424360816494,-0.560312547289098,0.767965767208084,0.963769767916413,1.14774374963618,1.17485244026535,-1.06854502864103,-0.827316322963549,-1.79475791912789,1.46702800278902,-1.05116192825318,-0.805825978302577,-1.5425614568528,-1.48086271750083,-0.1765634378399,0.899443074641424,1.753919563763,0.820109365928032,-1.20027937384974,1.25760712833662,-0.51430697135673,-0.521981355127377,-0.323713779701241,0.551358719954826,-1.10274596189647,0.378396026809695,0.444825649933257,0.356483340845022,-0.0278827617859778,0.8777007523023,-0.940151740812632,1.88570072549972,0.252401728801092,0.579637144880412,0.753259688269515,0.175233645719988,1.99113363412031,-0.834022170065189,-0.277623586268434,0.214037793222247,0.775546453176706,2.53315566596675,-4.12561058524893,0.0723104092064958,-0.620463718850542,-1.47277108579875,2.1098889469722,0.582021240086898,0.974636279371485,2.44788506562885,0.916367104944477,0.587293358000505,0.0815853938556398,-7.0467481055753,-2.88839471584505,-0.564238680641031,-0.581677409699634,7.89181880949027,4.20532464876096,0.492873478208308,0.855256410118991,10.1369271528328,16.0532125331924,-0.303841814668313,-0.765509721403518,2.45680171406726,-0.0618180690267791,0.732521400671835,-2.48922189036587,-0.438653793956196,-0.00833347167245203,0.274582795679262,0.140309869699428,-1.26127350812076,-9.90481549236658,-0.520866452265324,0.435841708372868,0.0958837118687839,6.59129205223629,4.31075444996901,-2.79317111974563,0.78216817783883,0.187759999328851,-0.164333491767158,-0.268889199143538,-0.664879055373748,-0.936599639360963,2.29823975466286,0.171285761476689,-0.797149231556535,-0.315041342194961,1.15424676597796,-1.00787269002727,-0.993888820110467,-0.364011088663059,2.7960712568345,0.411133974396647,-0.132198317755803,-1.07865846395526,2.99037424639774,-0.603618751278501,-1.06523185015898,0.220992584113576,13.7795195111437,-0.199298153868591,-0.880324336412598,-0.516633508380791,0.0845788339335565,0.279823608821529,0.0453471323976153,-1.41434571902925,1.78616596555916,0.657325332329003,0.201919199116043,-0.135968889483695,0.882083824326884,-0.343477273207194,-0.305546734083222,0.282377286493687,1.08136399128105,-3.21955637502686,0.622205045687135,-0.296342521512991,-3.3364981540908,4.27921762352115,-0.145011395992545,0.68447053635719,-18.6739526189705,-5.85247861031487,1.16094953497832,-0.185167541239136,-4.77612025053043,-3.01728570372859,0.253874153812444,-1.17918439455095,-2.35033969704497,-1.32983870164873,0.269748227487496,0.59919276846639,0.540079055975685,8.46541843615942,1.35469461316027,-0.355137032768461,-0.86528021941799,-0.741543058866624,0.196944856200931,-1.76052060771075,2.03049974160345,1.26302570691089,-4.08991372194439,-2.87590175190542,0.760416004087092,2.24758479530866,-1.74647761676662,-0.624097933615263,0.107764230646908,-1.46193215623959,-0.598889934329022,5.95777262250946,-0.665132013225061,-0.778282562433436,2.61322236610905,-0.804354576634969,-0.432913510903667,1.01375035537817,-2.64187448665909,2.60190603793523,-1.86566433828476,0.985098129027892,0.698669116107305,0.803648586467348,-0.127958537075254,2.20649263520286,-5.90459975767479,1.21677886411529,-0.128120075393084,-0.534077463317322,-11.0443339775359,-0.183070140696048,0.288277369682236,7.23274567302321,0.393251757524419,-1.20347249482302,-0.366014799867071,-1.35205215906053,6.27114627409518,-1.8846072811999,-0.566456257099766,-1.27107216878343,-1.08236388715125,-0.392932047259227,-2.01496362378805,-3.24276564266709,-1.63498022770158,0.442164153969038,0.207564348784494,0.0684244723172907,-0.90494507005905,1.88276521875757,-0.747172672762612,-0.773712844298179,-13.0314989832303,-0.863630646881895,0.494044872308784,0.0149979168876508,1.07408388227549,-8.10829324454477,0.170298208248414,-0.237723071402213,1.1770771471174,1.61079958084804,1.68712240393634,-0.535527294368416,1.30612382515273,-6.64461757108109,1.06112964133516,0.704430505086134,4.8560129724712,3.8184918116676,-4.64869311119204,0.540015660113087,2.68005950444064,-1.45510447679023,-0.843431793508516,-0.655611858613263,-0.821505396331421,1.84076883315263,0.752096654317132,0.573880453467622,0.678722292348114,0.961165456409409,-3.04708217436925,1.64789532205107,-0.16511720363998,-1.72414146048722,1.23314078718614,1.04252665638789,-0.227106556261854,-2.00095926174674,5.31971952672707,4.77912135654061,-0.748453403577988,1.60538185631545,4.59438011160074,0.896365066966809,-0.0225673337751792,2.43947394703164,4.26753159417311,0.483267204627271,-0.780896242356825,9.20306080846627,15.0829088419689,-0.990227280949312,0.505589316286175,3.46831364550674,-7.521246277196,-1.01949439003402,0.276256038928753,0.262899326697246,0.504936847321513,0.868094648078894,0.577779823378203,-4.64664239718957,0.329644347299669,0.0150382056011744,0.56338055937898,-0.810661894811276,-1.98997108678064,1.28454740059741,1.32326263919086,-11.5866101589927,0.167816662102272,1.836736113954,-0.61662920256562,0.223975521817444,-3.29354505261553,1.98456873349652,0.883859794598687,-1.46776551989052,1.93478088459317,1.59787406894725,-1.08513303886008,-2.12390277699196,-2.41386062891354,4.68104871554942,0.783955846768075,0.639178241488098,-4.00657627744347,4.63688316669919,-0.175501957315688,-1.08236106233475,6.80021092343401,-5.78222955603658,-3.57919272010502,-0.564755501985607,10.0168539749804,-1.39894245744519,0.930011558345982,0.832873035944764,-10.082671453711,4.61964964157688,0.0785750517641374,-0.843468245357165,0.23941302197937,-15.9453431058701,-1.00127550309812,-0.598628547616906,6.9462268057138,-0.952317957917029,-2.29719221363684,-0.0237353520719227,-14.5638813514655,0.932779228207327,6.35247133376469,9.53884941329822,-0.420309847643757,-0.0507451838607871,1.46090374147887,-0.60352057537782,0.267349143776289,0.661979647845497,1.8773326630521,0.101883985907763,0.832782089832085,-2.05208260092681,1.48712458101777,0.958109285695314,0.519206682406626,1.08255210467341,2.83786391655873,0.967669891583752,-0.342156125077442,-2.31035595357208,0.591999452353547,0.739352150271792,-0.392413349588481,0.31991303661169,-1.71435065710344,-1.93101128907976,0.0145949849938535,0.782796387615909,-4.89642054594237,-0.491447236391646,-0.042694682300744,-0.595371952919136,0.401809196170306,-1.43029465317576,0.377694566163989,-2.44807372726164,5.16986111251888,0.717303023189445,0.610496864064899,0.647454250636794,-0.84766261384963,-1.33443662906694,1.25722203226163,0.747920284843425,0.216347925686797,3.3094108820011,-0.640226749973108,0.127673270482778,1.14697775533803,-0.478338391396824,0.123599065106914,0.100105651008964,0.488771194473458,-0.0470085782310856,0.285050589632111,0.574503468796212,2.50739552462845,1.13730610500541,-0.189345809247267,-0.526956779043104,1.3194704717231,1.55971219189664,-0.160213860289005,0.267623115754294,0.75104348189025,-0.0934569786912911,-0.521991967732899,0.677070220365321,2.63677599159285,-0.241666584792004,0.226788407067818,-0.209243387945642,2.7518380893687,3.1063742837653,-0.87488515372242,0.843889494294177,1.45525722290967,0.132127683109294,-1.62210331493551,0.220855286823222,3.32618025789794,0.0831974681689363,-4.44238597754274,-4.69851609028967,0.56024262055287,-7.73257538633448,-10.7203154958675,4.04481602205561,-1.12216106330089,-2.7636718206709,6.92422679338551,4.17044885542432,0.368754709762071,-1.99461324517679,0.638758782703348,-0.389154272816321,0.722908725259156,17.7675414873666,-0.328597586017235,1.11110907356635,0.0682147655890779,17.1454293061329,1.52321698352752,2.41080297457669,-0.940164548577912,12.3331396586621,3.95979364017329,0.486923868640219,0.119301080437758,8.53263592691071,-4.80631709189359,-0.737791582314522,-0.0851363849783414,0.986819335930819,-7.39337697217432,6.57319186996875,-0.680865288927108,-7.60334313077872,9.27556723685579,-0.013128790069228,0.378118613970289,-0.636495771981087,0.819330187020293,4.90742037890114,-0.822602824091309,0.134017268806451,-6.85722358170379,0.115645782857725,-4.27587217200528,0.592073014920817,-0.644407610248344,-3.32518383573353,-4.11470770429661,-0.609097960405689,1.65558660769106,-0.838437382079106,-0.37055741519646,0.364026927038242,1.11255111247297,-2.49524384403847,-0.68314286660214,-0.130145900066664,-4.40527880677008,-1.65598289282453,0.355089767293582,-0.476764097994188,-11.0368189067235,3.80177838729911,0.294161615773209,-0.887856708820993,2.05356754120872,11.485257381696,1.2401831593594,0.92950816314378,-9.3521706365742,29.0914872392362,1.78592711562186,-0.755951454817711,-0.60096571873064,-2.50123773899529,3.99798408496752,0.0422801962791175,4.30107279636593,-0.0747118940658174,-0.374861426662814,-3.98446257695118,1.65290305634952,0.750679922138966,0.486229177379187,0.862147263303952,-0.00749211353929147,-1.80325828525754,10.5729253834661,2.00964074881695,0.462684574281857,-0.337228660404486,0.881149375335959,0.48878394651032,-0.815701977578447,-1.85205988926798,-4.87048305094261,-0.321253247125781,-3.0770649081933,2.51451559673082,-5.00187648395828,-0.0675777127663708,-0.758145812080174,-2.84141299942218,-7.08474043700112,-0.327635683540053,-0.879161981064521,-0.0918118288004584,-1.22712498288773,1.37191585124644,0.65634804255795,3.10435088218832,-2.00336986701999,-0.511965071818389,-0.503921058408755,0.228032740310631,1.54191840710711,-0.0735266927778047,0.147029488755737,0.902645851403676,0.444505583166675,-0.0902191831032359,0.426792886222389,0.791258994264179,-0.612854117523527,0.327937402061445,0.298467457553608,3.22325855531358,-2.15729764991516,-1.93780644864971,0.470072673353055,1.26478061214858,-1.33078974110629,-0.627910407286817,0.928563447419334,1.13131135095814,0.303750860690171,4.49858460530637,-0.568602922945418,1.16474448525757,1.09010773799944,-1.42028980198042,0.31120550098248,-0.235356667959262,-0.346218636748366,-2.14805108122297,-0.601230730760433,-0.385070778937536,0.625949656002801,-0.446919351419113,0.357984980054441,1.07368954249944,1.38564989444616,-0.307213900864317,-1.0614426117793,0.397215359697734,0.148916211521204,-3.45273060325631,-0.605617936542461,0.912304693359391,1.17966867297585,0.754604734453076,-2.94641009919142,-3.24278579992815,0.508908557321716,0.542634845654627,-0.320205166597196,0.0759021088125598,2.08370363031834,-2.81877916541732,-2.01155741374287,0.738530323136615,-0.503045426190614,-2.7277875779783,-1.27457375678681,0.281464116746537,-0.101268715731621,-0.896682139442469,2.03130125130191,0.909001194113115,0.803660928638108,2.23881963351901,-2.50077126106682,0.244017417277837,0.214590486949151,-2.11790738366897,1.92607246890486,-0.262315206885058,-0.0868402573150492,0.525900368850405,4.4572411034175,-0.91839591822392,-0.111089138176243,2.23673488734808,-2.88242324316043,-1.70708825287804,-0.963006889813666,-0.0249594952399212,15.9614677301062,-0.576095247763931,0.357446560055509,-9.90010902456965,-0.938380121020258,-0.471921086804902,2.14207619081976,-0.426561464203949,-1.19296784588901,-1.25999944672819,0.285067559954147,1.04014702069096,0.557930012266715,0.157287472811504,-0.265891316241725,2.29710276132631,-0.6962738676968,-1.75316324003241,0.0299912515143549,-0.912575221133669,-0.016914549427193,-0.0710137332479248,-2.06221993047238,0.697839846989851,0.470627052800202,0.857185290040259,-0.660884875148383,-0.982598209966498,-2.09543717869993,0.909348644841374,-0.995712327096699,-0.739508704668557,-1.09764996682485,0.376567312332483,-0.699525710584655,0.989679740248081,0.385672072436501,0.889374658247335,-2.56437408232424,-0.58446557091924,-0.522446348249766,-7.10100958864654,-0.983460133619691,0.464202216216475,2.21394142283853,0.775237154744367,-2.65836876455134,0.989525191955056,-0.665725659412989,0.723847094244297,-6.40385956248836,1.70046068898798,0.115453240585005,-5.41952726426979,-0.23861616866477,1.75589065536124,0.406397198094629,3.63442042657918,-5.5403835992291,0.0175442655440618,0.186783108805778,-3.53354593648719,-3.45354770551607,-0.20853957221415,0.853551449658062,3.46062159956307,-4.80409093446437,-0.512901945823934,-0.655402898894815,0.125554217506833,23.1724369941043,-0.20606302082591,-0.761120643144383,-2.22627316684989,-0.689634365427985,0.427266101552023,-0.488232922569599,0.896139533701894,-2.47822282013434,3.25172549298989,0.634951142392274,-0.482300635772899,5.06481123492654,-0.78501367725113,-0.284741786531865,-12.4058519187472,-0.804285713144518,-1.2083537458729,0.0781836516189366,0.0920157587299284,-0.156982418395726,-0.771634925582718,-0.340508717613361,-0.0862805154624111,-1.22564135142877,0.695752390034327,0.121819387435786,1.39242505381565,1.94485591642204,2.53447144358909,0.488579869910737,-0.235015515025887,-1.23023212524081,-0.638672450862399,0.603573137763204,-0.0422492841875218,-1.72587935964372,-1.36514640886826,0.796411162959912,1.15540535927939,-1.4856082122865,-9.03847037512546,0.674961571632077,0.161338706992606,0.884612710418142,-0.859337546623675,1.24210717061106,0.00351627288168669,-0.677487564603809,-11.3416447622938,0.501157485308403,-0.36565625569777,2.04090980099016,-13.566246940074,-0.76818557386235,-0.163014640364993,-0.296026800524868,0.239665344369479,3.5824642838018,-1.53244806965657,1.08728332172997,-1.47382238113544,-1.11156288661712,-0.651282319593757,-0.486844096464366,-1.10880172535316,1.26230881484296,0.602410249816443,-0.995036257968006,7.33941789354471,2.7290774560095,-3.45274526267661,-5.74507822281775,-1.09681853627333,6.74118977580807,-0.578322906172883,-4.65081913326992,-0.829254323053279,5.21697378624244,0.681239586519009,0.524846437136663,4.30982808673426,-1.00770886558939,-1.06769619435557,-0.745129212414346,-7.08535749323248,1.06006550774726,0.0481054122124865,0.300695860351029,-2.42537396821461,-2.31103587359838,-0.964450699372397,-0.220157435137973,-0.7652574471876,-4.99794118831491,-3.70155752956157,-0.508704197793349,0.0470139394884441,0.719262693392955,-3.4150544738763,1.74596178859493,-0.485000483448756,1.14278779763582,0.649238539340621,0.389987004201058,0.118691426413757,4.07008308270477,-0.807342035437523,-7.0585276246469,0.0616906411173968,0.844944915473985,-3.48795421315834,-1.28965563423402,0.0459127957003429,0.14701688169695,-0.224458920283801,-1.25668018538038,0.538949474789294,4.66320234009299,3.22934384827668,-5.28156891108313,-0.0133092394504702,-5.77902482602633,0.286679348631059,-0.58362420031142,0.500143826524907,-0.984221886703858,2.35736402204484,-0.71615351722929,-0.65113870753661,-4.66550286508859,2.43361134739109,-9.63950560390962,0.141510587775996,-0.580793168583001,3.70985254199397,-3.45806226000391,-0.429957671781292,-3.46228319145661,0.406956714881991,0.159151287201034,-0.933690227036388,-0.47465333642074,-0.203256738579762,-0.665398458452416,0.211855746444476,3.65987023411621,1.32621908495402,2.68274683283404,0.485382580962565,0.672517696711519,7.92746556386473,-1.13372264484312,0.78509193379613,-0.133393816892502,-0.0181399363492643,0.024271482940168,-0.225904354975677,0.847659731900137,-0.252174912931143,0.277428982009959,1.00098264671912,-0.24744860520001,6.586550562397,-0.380644531183762,0.609422197785515,-0.137159951321988,0.883204738765322,-1.69205449495723,-1.25474237622546,0.443376863023307,-0.550951836025319,0.158008354126469,-1.16717707027538,0.40885147170756,-1.71044251039199,-1.51305870582073,2.84773556196596,-0.395553059618485,0.405757216672903,-0.924075767100597,0.846163176174972,-0.959600686355878,0.117497682117952,-0.20641867007739,-0.274476824117198,-0.797716473627815,-0.143553744509582,1.68348578141114,-1.76573099823359,0.391694827528997,0.39955679186413,-0.904586437252732,-0.508872001270726,-1.08503780393065,0.720108168840376,-0.279318555127486,2.7843232017271,0.43154477796878,0.111332491813167,-0.141747350112365,-3.76787109996629,-0.845935358978224,0.542224605491409,-5.55099805542601,-0.170245065027299,-0.439620156722327,0.883079347187454,-6.30228889027502,-0.361090664353111,1.30775813912849,-0.631077763971869,-8.60194245455753,-0.804256907500154,1.19556235730742,-0.296221476679016,0.739095707694048,0.388373364633302,0.688130266052752,-0.124099385053358,-1.34197705602144,-0.76081522593281,0.155133004357671,0.558860761870211,0.252218578735679,-0.770148415299403,1.04485358528774,-0.152598700711873,0.32779611171291,-1.26336511109011,0.0527531272992875,-2.90877579647752,1.6197875603329,-1.88512960641265,-1.90218904577608,-1.3734372379814,-0.527536179766347,0.698207491440411,3.24845427551237,-1.37079804034797,-0.00272687218397857,2.33624209627724,-1.75123991465659,0.381066832195984,-0.470947623473306,-2.40898769690665,0.206040291976532,0.622864970428069,1.03670386186332,2.62921923893594,-4.17141357527949,0.23467634261463,-0.108791145008647,-1.63879367407367,0.476598639633934,-1.97970081654802,-0.0464443158917436,1.79682173923122,-1.35348016191481,-0.754644067979358,-0.8540467225354,1.7247402973693,0.0843828014212923,-1.69292312476958,-0.993896655467998,0.631527234808391,4.12018069534642,0.482677616905169,1.93485527061764,1.05275854902418,0.871989213256342,1.92142723449304,0.950013054830825,1.57968075563581,2.12490585672448,-1.20512895289804,-0.428352323101665,0.642356899955894,0.215895872673249,0.31946042415739,-0.893816385255983,0.0699466816628921,1.54763847815452,-0.124442146282791,0.343321195783607,1.14822120981237,1.92345572735298,1.51373170259901,-0.248958272735013,-0.757035869933667,-0.865707220060548,1.92878898266261,-1.32310623842478,-0.0562619004347824,-0.821667913656831,0.983044576605659,1.34479947476964,-0.0657482964015214,3.18541755310625,1.27195439782359,-0.939349287628004,-0.713669257815723,2.72120488681289,-0.870189603427622,-1.11906471951144,1.03671340856076,0.585645916910236,2.61788121304818,-1.60986967776354,0.0813873614467129,0.97710891246119,0.12079818203155,-2.35742354622391,-0.815151089944517,1.19440080206367,2.57936269898086,-0.494472189545602,-0.129923783109892,0.612548178657066,9.70861845815218,-2.42589629321286,-1.34234862412775,-0.258056775664603,1.17873924779748,-4.60792968441286,1.16726597801136,-0.330155280249474,-10.5262969962568,-10.0747832119799,0.0998978611011786,0.218338579190242,0.145357098158806,-20.2731403240367,-0.903097698632388,-0.867672070960202,-0.802502651418778,-6.87830008398178,4.36937989431962,-0.493485303755801,-1.1317367367968,-4.85829459510794,1.68880744830529,-0.927078840047481,2.4415721614425,0.129768296430523,-0.660618020401827,1.864729507604,-0.741916729103978,-0.824842546705391,-1.13437782565027,-0.411784432924483,-0.158004612921222,0.804183695946128,2.07673195314741,-0.658259979412563,0.616576083978639,-0.383989998475307,0.582674977997669,0.828231527512454,0.423839017691139,-1.24339244887181,0.841557532869067,-0.918815457963832,0.356868946344891,-0.555834596385028,-0.455731314669886,0.118922606476137,1.94459519348645,0.812333709971712,0.128472304313836,-0.869894953606508,0.875207598387079,1.02967060106925,0.296533616755802,-0.865714586261338,0.108451363390269,1.43299839729497,0.712730485355211,0.791739561698044,0.876358325441096,0.610821526735171,-1.11658538276997,-0.467588226719112,0.869108913294992,1.33891814600827,-0.551371972927075,-4.05760701603702,0.169875212114059,-0.968223150410324,-5.75636544226679,-9.11690625692214,0.103779975001898,-1.53738782820398,-4.91295892092228,-6.34314135860604,1.05636757480933,-0.481872289446778,-4.69265656402533,16.9871115407268,0.69125283582297,-0.364473338662404,12.0624990340088,21.4714669270311,-1.00889981575037,-0.994603154520523,-0.442389981820672,11.9950830184954,1.07878071034456,-0.107680887349947,0.872482736064833,39.2891153590093,-0.103891582262061,-0.109629922736364,8.94798175658041,7.01473101428617,-4.05267480653346,-0.0127843902541479,-1.80847401323389,-133.130564102008,-0.297542388616347,-0.782255857889702,-0.0258108149351048,2.99710093998705,-1.18515531109547,-0.498595004899947,-5.73869411962012,0.734668454905925};

typedef double (*Activation)(double);

typedef struct _network {
   int layerCount; 
   double *weight;
   int *weightOffset;
   int *neuronCount; 
   int *bias;
   Activation *activation;
} Network;

double sigmoid(double x) {
  return 1 / (1 + exp(-x));
}

Network network;

void setup() {
  Serial.begin(57600);
  network.layerCount = 3;
  network.weight = WEIGHT;
  network.weightOffset = new int[network.layerCount]{1763, 123, 0};
  network.neuronCount = new int[network.layerCount]{40, 40, 3};
  network.bias = new int[network.layerCount]{1, 1, 0};
  network.activation = new Activation[network.layerCount]{sigmoid, sigmoid, sigmoid};
}

void loop() {
  int inputNeurons = network.neuronCount[0];
  int outputNeurons = network.neuronCount[network.layerCount - 1];
  double input[inputNeurons];// = {-117.45/2000,-595/2000,-1948.9/2000,4175.3/10000,484.9/2000,-655.3/2000,-2037.05/2000,621.25/10000,373.5/2000,-579.25/2000,-2065.95/2000,174.3/10000,21.95/2000,-529.4/2000,-2023.6/2000,729.2/10000,-63.6/2000,-716.6/2000,-1979.35/2000,76/10000,-191.5/2000,-708.9/2000,-1990.45/2000,590.55/10000,-91.45/2000,-859.9/2000,-1899.55/2000,-1227.95/10000,71.45/2000,-422.95/2000,-2084.75/2000,-2760.85/10000,121.7/2000,-418.3/2000,-2103.3/2000,247.75/10000,-9.7/2000,-496.1/2000,-1958/2000,-702.25/10000};
  double output[outputNeurons];
  readInput(input, network.neuronCount[0]);
  compute(network, input, output);
  for(int i = 0; i < 4 * outputNeurons; i++)
    Serial.write(*((byte*)output + i));
}

void readInput(double input[], int inputCount) {
  for(int i = 0; i < inputCount; i++) {
    byte bytes[4];
    while(Serial.available() < 4);
    bytes[0] = Serial.read();
    bytes[1] = Serial.read();
    bytes[2] = Serial.read();
    bytes[3] = Serial.read();
    input[i] = *((float*)bytes);
  }
}

void compute(Network network, double input[], double output[]) {
  //Initialize arrays to hold input and output values during layer computation.
  int maxNeurons = 0;
  for(int layer = 0; layer < network.layerCount; layer++) {
    maxNeurons = max(maxNeurons, network.neuronCount[layer] + 1);
  }
  double tempIn[maxNeurons], tempOut[maxNeurons];

  //Initialize input
  for(int i = 0; i < network.neuronCount[0]; i++) {
    tempIn[i] = input[i];
  }
  tempIn[network.neuronCount[0]] = network.bias[0];

  //Calculate output for each layer
  for (int layer = 1; layer < network.layerCount; layer++) {
    int offsetIndex = network.weightOffset[layer];
    int fromCount = network.neuronCount[layer - 1] + network.bias[layer - 1];
    int toCount = network.neuronCount[layer];
    Activation activation = network.activation[layer];

    //For each neuron in the next layer
    for (int toNeuron = 0; toNeuron < toCount; toNeuron++) {
      //Calculate weighted sum from the current layer
      double weightedSum = 0;
      for (int fromNeuron = 0; fromNeuron < fromCount; fromNeuron++) {
          weightedSum += pgm_read_float_near(network.weight + toNeuron * fromCount + fromNeuron + offsetIndex) * tempIn[fromNeuron];
      }

      //Apply activation function
      tempOut[toNeuron] = activation(weightedSum);
    }

    //Prepare input for next layer
    for (int toNeuron = 0; toNeuron < toCount; toNeuron++) {
        tempIn[toNeuron] = tempOut[toNeuron];
    }
    tempIn[toCount] = network.bias[layer];
  }

  //Output from last layer
  for(int i = 0; i < network.neuronCount[network.layerCount - 1]; i++) {
    output[i] = tempOut[i];
  }
}
